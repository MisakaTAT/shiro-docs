import{_ as s,c as n,o as a,d as l}from"./app.8d3b51b0.js";const i=JSON.parse('{"title":"\u8FDB\u9636","description":"","frontmatter":{},"headers":[{"level":2,"title":"Matcher","slug":"matcher","link":"#matcher","children":[]},{"level":2,"title":"\u6D88\u606F\u6784\u5EFA\u5DE5\u5177","slug":"\u6D88\u606F\u6784\u5EFA\u5DE5\u5177","link":"#\u6D88\u606F\u6784\u5EFA\u5DE5\u5177","children":[]},{"level":2,"title":"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F","slug":"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F","link":"#\u4E3B\u52A8\u53D1\u9001\u6D88\u606F","children":[]},{"level":2,"title":"\u6D88\u606F\u94FE","slug":"\u6D88\u606F\u94FE","link":"#\u6D88\u606F\u94FE","children":[]},{"level":2,"title":"\u8F85\u52A9\u5DE5\u5177\u7C7B","slug":"\u8F85\u52A9\u5DE5\u5177\u7C7B","link":"#\u8F85\u52A9\u5DE5\u5177\u7C7B","children":[]},{"level":2,"title":"\u5408\u5E76\u8F6C\u53D1","slug":"\u5408\u5E76\u8F6C\u53D1","link":"#\u5408\u5E76\u8F6C\u53D1","children":[]},{"level":2,"title":"OneBotMedia","slug":"onebotmedia","link":"#onebotmedia","children":[]},{"level":2,"title":"\u62E6\u622A\u5668","slug":"\u62E6\u622A\u5668","link":"#\u62E6\u622A\u5668","children":[]},{"level":2,"title":"CoreEvent","slug":"coreevent","link":"#coreevent","children":[]},{"level":2,"title":"\u81EA\u5B9A\u4E49\u8BF7\u6C42","slug":"\u81EA\u5B9A\u4E49\u8BF7\u6C42","link":"#\u81EA\u5B9A\u4E49\u8BF7\u6C42","children":[]},{"level":2,"title":"\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6","slug":"\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6","link":"#\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6","children":[]}],"relativePath":"advanced.md","lastUpdated":1667529287000}'),p={name:"advanced.md"},o=l(`<h1 id="\u8FDB\u9636" tabindex="-1">\u8FDB\u9636 <a class="header-anchor" href="#\u8FDB\u9636" aria-hidden="true">#</a></h1><h2 id="matcher" tabindex="-1">Matcher <a class="header-anchor" href="#matcher" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">\u6CE8\u610F</p><p><code>Matcher</code> \u7C7B\u4EC5\u9002\u7528\u4E8E\u6CE8\u89E3\u65B9\u5F0F\u5F00\u53D1\uFF0C\u53EF\u4EE5\u8FD4\u56DE\u6CE8\u89E3 <code>cmd</code> \u53C2\u6570\u6B63\u5219\u7684\u5339\u914D\u7ED3\u679C</p></div><div class="tip custom-block"><p class="custom-block-title">\u5EFA\u8BAE</p><p><code>Matcher</code> \u7684\u7528\u6CD5\u57FA\u4E8E\u4F60\u5BF9\u6B63\u5219\u7684\u7406\u89E3\u7A0B\u5EA6\u6709\u591A\u5C11</p><p>\u4F8B\u5982\u6709\u4E00\u4E2A\u573A\u666F\u4E3A\u9700\u8981\u8BBE\u8BA1\u4E00\u4E2A\u6E38\u620F\u6218\u7EE9\u67E5\u8BE2\u63D2\u4EF6</p><p>\u6B63\u5219\u8BBE\u8BA1\uFF1A<code>^\u6218\u7EE9\u67E5\u8BE2\\s(.*)?$</code></p><p>\u5339\u914D\u6D88\u606F\uFF1A<code>\u6218\u7EE9\u67E5\u8BE2 MisakaTAT</code></p><p>\u6B64\u65F6\u53EA\u6709\u5339\u914D\u7684\u6D88\u606F\u5185\u5BB9\u53EF\u4EE5\u89E6\u53D1\u6B64\u63D2\u4EF6</p><p>\u901A\u8FC7 <code>matcher.group(1)</code> \u5219\u53EF\u4EE5\u53D6\u51FA <code>MisakaTAT</code> \u8FD9\u4E2A\u6E38\u620FID</p></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Shiro</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Component</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExamplePlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">GroupMessageHandler</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">cmd</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5F00\u542F|\u5173\u95ED</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">test1</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">GroupMessageEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Matcher</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">matcher</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> action </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> matcher</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">group</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">switch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5F00\u542F</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">                System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5F00\u542F\u4E8B\u4EF6\u89E6\u53D1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">case</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5173\u95ED</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">                System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5173\u95ED\u4E8B\u4EF6\u89E6\u53D1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">default:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">GroupMessageHandler</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">cmd</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^\u6218\u7EE9\u67E5\u8BE2</span><span style="color:#A6ACCD;">\\s</span><span style="color:#C3E88D;">(.*)?$</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">test2</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">GroupMessageEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Matcher</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">matcher</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> gameID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> matcher</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">group</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">queryGameStats</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">gameID</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u6D88\u606F\u6784\u5EFA\u5DE5\u5177" tabindex="-1">\u6D88\u606F\u6784\u5EFA\u5DE5\u5177 <a class="header-anchor" href="#\u6D88\u606F\u6784\u5EFA\u5DE5\u5177" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">\u63D0\u793A</p><p><code>MsgUtils</code> \u4E3B\u8981\u7684\u7528\u9014\u662F\u4E3A\u4E86\u80FD\u591F\u4FBF\u6377\u7684\u6784\u5EFA\u5305\u542B\u591A\u79CD\u7C7B\u578B\u7684\u7EC4\u5408\u6D88\u606F</p><p>\u66F4\u591A\u7C7B\u578B\u8BF7\u89C1 <code>com.mikuac.shiro.common.utils.MsgUtils</code></p></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> msg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MsgUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">builder</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">atAll</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">                        </span><span style="color:#676E95;">// @\u5168\u4F53\u6210\u5458</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">img</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://test.com/1.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// \u5305\u542B\u4E00\u5F20\u56FE\u7247</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hello~</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">                 </span><span style="color:#676E95;">// \u5305\u542B\u4E00\u6BB5\u6587\u672C\u5185\u5BB9</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;">                       </span><span style="color:#676E95;">// \u6784\u5EFA\u6D88\u606F</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4E3B\u52A8\u53D1\u9001\u6D88\u606F" tabindex="-1">\u4E3B\u52A8\u53D1\u9001\u6D88\u606F <a class="header-anchor" href="#\u4E3B\u52A8\u53D1\u9001\u6D88\u606F" aria-hidden="true">#</a></h2><blockquote><p>\u5728\u5B9A\u65F6\u4EFB\u52A1\u6216\u8005\u67D0\u4E9B\u9700\u8981\u4E3B\u52A8\u53D1\u9001\u6D88\u606F\u7684\u573A\u666F\u4E0B\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\u53D6\u51FA Bot \u5BF9\u8C61</p></blockquote><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u6CE8\u5165 Bot \u5BB9\u5668</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Resource</span></span>
<span class="line"><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">BotContainer</span><span style="color:#A6ACCD;"> botContainer</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sendMsg</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u673A\u5668\u4EBA\u8D26\u53F7</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">long</span><span style="color:#A6ACCD;"> botId </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">123456789L</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u901A\u8FC7\u673A\u5668\u4EBA\u8D26\u53F7\u53D6\u51FA Bot \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> bot </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> botContainer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">robots</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">botId</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u8C03\u7528 Bot \u5BF9\u8C61\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">    bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendPrivateMsg</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">12345L</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hi~</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u6D88\u606F\u94FE" tabindex="-1">\u6D88\u606F\u94FE <a class="header-anchor" href="#\u6D88\u606F\u94FE" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">\u6CE8\u610F</p><p>\u6B64\u53C2\u6570\u4EC5\u5728 <code>Shiro v1.1.7</code> \u53CA\u4EE5\u4E0A\u7248\u672C\u63D0\u4F9B</p></div><blockquote><p>\u4EE5\u4E0B\u793A\u4F8B\u4E3A\u8FC7\u6EE4\u51FA\u672C\u6B21\u6D88\u606F\u4E2D\u7684\u6536\u5230\u7684\u6240\u6709\u56FE\u7247\u5E76\u6253\u5370\u56FE\u7247\u7684\u94FE\u63A5\uFF0C\u66F4\u591A\u7C7B\u578B\u53EF\u4EE5\u6253\u5370 <code>event.getArrayMsg()</code> \u81EA\u884C\u67E5\u770B\uFF0C\u540E\u7EED\u8003\u8651\u52A0\u4E0A\u7C7B\u578B\u679A\u4E3E\uFF0C\u6B22\u8FCEPR</p></blockquote><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Component</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExamplePlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BotPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onPrivateMessage</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PrivateMessageEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getArrayMsg</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stream</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">type </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">image</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equals</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getType</span><span style="color:#89DDFF;">()))</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">image </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">image</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)));</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> MESSAGE_IGNORE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u8F85\u52A9\u5DE5\u5177\u7C7B" tabindex="-1">\u8F85\u52A9\u5DE5\u5177\u7C7B <a class="header-anchor" href="#\u8F85\u52A9\u5DE5\u5177\u7C7B" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">\u63D0\u793A</p><p>\u4EE5\u4E0B\u65B9\u6CD5\u5747\u7531 <code>com.mikuac.shiro.common.utils.ShiroUtils</code> \u63D0\u4F9B</p><p>\u8BE6\u7EC6\u7528\u6CD5\u89C1\u65B9\u6CD5 <code>ShiroUtils</code> \u6CE8\u91CA</p></div><ul><li><strong>\u73FE\u5728\u516C\u958B\u53EF\u80FD\u306A\u60C5\u5831\uFF08\u5DF2\u652F\u6301\u7684\u65B9\u6CD5\u5217\u8868\uFF09</strong><ul><li>\u6D88\u606F\u7F16\u7801 <code>escape()</code></li><li>\u6D88\u606F\u89E3\u7801 <code>unescape()</code></li><li>\u83B7\u53D6\u7528\u6237\u6635\u79F0 <code>getNickname</code></li><li>\u5224\u65AD\u662F\u5426\u4E3A\u5168\u4F53@ <code>isAtAll()</code></li><li>\u83B7\u53D6\u7FA4\u5934\u50CF <code>getGroupAvatar()</code></li><li>\u83B7\u53D6\u7528\u6237\u5934\u50CF <code>getUserAvatar()</code></li><li>\u83B7\u53D6\u6D88\u606F\u5185\u6240\u6709\u56FE\u7247\u94FE\u63A5 <code>getMsgImgUrlList()</code></li><li>\u83B7\u53D6\u6D88\u606F\u5185\u6240\u6709\u89C6\u9891\u94FE\u63A5 <code>getMsgVideoUrlList()</code></li><li>String\u6D88\u606F\u4E0A\u62A5\u8F6C\u6D88\u606F\u94FE <code>stringToMsgChain()</code></li><li>\u521B\u5EFA\u81EA\u5B9A\u4E49\u6D88\u606F\u5408\u5E76\u8F6C\u53D1 <code>generateForwardMsg()</code></li><li>\u4ECE MsgChainBean \u751F\u6210 CQ Code <code>jsonToCode()</code></li><li>\u6D88\u606F\u7F16\u7801\uFF08\u8F6C\u4E49CQ\u7801\u9632\u6B62\u6587\u672C\u6CE8\u5165\uFF09 <code>escape2()</code></li><li>\u83B7\u53D6\u6D88\u606F\u5185\u6240\u6709@\u6210\u5458\u8D26\u53F7\uFF08\u4E0D\u5305\u542B\u5168\u4F53@\uFF09 <code>getAtList()</code></li></ul></li></ul><h2 id="\u5408\u5E76\u8F6C\u53D1" tabindex="-1">\u5408\u5E76\u8F6C\u53D1 <a class="header-anchor" href="#\u5408\u5E76\u8F6C\u53D1" aria-hidden="true">#</a></h2><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u6784\u5EFA\u6D88\u606F\u5217\u8868\uFF08\u53EF\u4EE5\u586B\u5145 MsgUtils \u6784\u5EFA\u7684\u6D88\u606F\uFF09</span></span>
<span class="line"><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> msgList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">&gt;()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{{</span></span>
<span class="line"><span style="color:#A6ACCD;">    msgList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u8FD9\u662F\u7B2C\u4E00\u6761\u6D88\u606F</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    msgList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u8FD9\u662F\u7B2C\u4E8C\u6761\u6D88\u606F</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    msgList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u8FD9\u662F\u7B2C\u4E09\u6761\u6D88\u606F</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u6784\u5EFA\u5408\u5E76\u8F6C\u53D1\u6D88\u606F\uFF08selfId\u4E3A\u5408\u5E76\u8F6C\u53D1\u6D88\u606F\u663E\u793A\u7684\u8D26\u53F7\uFF0Cnickname\u4E3A\u663E\u793A\u7684\u53D1\u9001\u8005\u6635\u79F0\uFF0CmsgList\u4E3A\u6D88\u606F\u5217\u8868\uFF09</span></span>
<span class="line"><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">Map</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#A6ACCD;"> forwardMsg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ShiroUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">generateForwardMsg</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">selfId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> nickname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> msgList</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u53D1\u9001\u5408\u5E76\u8F6C\u53D1\u5185\u5BB9\u5230\u7FA4\uFF08groupId\u4E3A\u8981\u53D1\u9001\u7684\u7FA4\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendGroupForwardMsg</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">groupId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> forwardMsg</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u53D1\u9001\u5408\u5E76\u8F6C\u53D1\u5185\u5BB9\u5230\u79C1\u804A\uFF08userId\u4E3A\u8981\u53D1\u9001\u7684\u597D\u53CB\u8D26\u53F7\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendPrivateForwardMsg</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">userId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> forwardMsg</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="onebotmedia" tabindex="-1">OneBotMedia <a class="header-anchor" href="#onebotmedia" aria-hidden="true">#</a></h2><ul><li>\u652F\u6301\u7684\u53C2\u6570 <ul><li>file</li><li>cache</li><li>proxy</li><li>timeout</li></ul></li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u8BE5\u793A\u4F8B\u6784\u5EFA\u4E86\u4E00\u6761\u56FE\u7247\u6D88\u606F\uFF0C\u5E76\u4E14\u544A\u8BC9\u5BA2\u6237\u7AEF\u4E0D\u8981\u4F7F\u7528\u7F13\u5B58</span></span>
<span class="line"><span style="color:#C792EA;">OneBotMedia</span><span style="color:#A6ACCD;"> img </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> OneBotMedia</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Builder</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">file</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://example.com/1.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">cache</span><span style="color:#89DDFF;">(false).</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#676E95;">// \u6784\u5EFA\u6D88\u606F</span></span>
<span class="line"><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> msg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MsgUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">builder</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">img</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">img</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div><h2 id="\u62E6\u622A\u5668" tabindex="-1">\u62E6\u622A\u5668 <a class="header-anchor" href="#\u62E6\u622A\u5668" aria-hidden="true">#</a></h2><blockquote><p>\u914D\u7F6E\u6587\u4EF6\u6307\u5B9A\u62E6\u622A\u5668\u5B9E\u4F8B</p></blockquote><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">shiro</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">interceptor</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mikuac.example.interceptor.InterceptorExample</span></span>
<span class="line"></span></code></pre></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Component</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">InterceptorExample</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BotMessageEventInterceptor</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">preHandle</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">MessageEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u9884\u5904\u7406\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u5728\u89E6\u53D1\u4E8B\u4EF6\u524D\u505A\u4E00\u4E9B\u5904\u7406\uFF0C\u8FD4\u56DE\u503C\u4E3A false \u65F6\u672C\u6B21\u4E8B\u4EF6\u5C06\u4F1A\u88AB\u62E6\u622A</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u4F7F\u7528\u573A\u666F\u53EF\u4EE5\u662F\u9ED1\u540D\u5355\u68C0\u67E5\u6216\u68C0\u67E5\u6743\u9650\u7B49\u7B49\uFF0C\u5177\u4F53\u7684\u4F7F\u7528\u573A\u666F\u53EF\u4EE5\u53D1\u6325\u81EA\u5DF1\u7684\u60F3\u8C61\u529B</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// MessageEvent \u53EF\u80FD\u4E3A\u53F3\u8FB9\u8FD9\u4E09\u79CD\u7C7B\u578B PrivateMessageEvent\u3001GroupMessageEvent\u3001GuildMessageEvent</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">afterCompletion</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">MessageEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u5F53 preHandle \u8FD4\u56DE\u503C\u4E3A true \u65F6\u5219\u4F1A\u6267\u884C plugin-list\uFF0C\u6267\u884C\u5B8C\u6BD5\u540E\u8FDB\u5165\u5230 afterCompletion</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="coreevent" tabindex="-1">CoreEvent <a class="header-anchor" href="#coreevent" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">\u6CE8\u610F</p><p><code>CoreEvent</code> \u4EC5\u5728 <code>Shiro v1.3.9</code> \u53CA\u4EE5\u4E0A\u7248\u672C\u63D0\u4F9B</p></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Primary</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Component</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyCoreEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CoreEvent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">online</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Bot</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">bot</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u5BA2\u6237\u7AEF\u4E0A\u7EBF\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u4F8B\u5982\u4E0A\u7EBF\u540E\u53D1\u9001\u6D88\u606F\u7ED9\u6307\u5B9A\u7684\u7FA4\u6216\u597D\u53CB</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u5982\u9700\u83B7\u53D6\u4E0A\u7EBF\u7684\u673A\u5668\u4EBA\u8D26\u53F7\u53EF\u4EE5\u8C03\u7528 bot.getSelfId()</span></span>
<span class="line"><span style="color:#A6ACCD;">        bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendPrivateMsg</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">123456789</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u6211\u4E0A\u7EBF\u5566\uFF5E</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">offline</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">long</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">account</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u5BA2\u6237\u7AEF\u79BB\u7EBF\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u8BF6\uFF5E\u6211\u53C8\u79BB\u7EBF\u4E86</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">session</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">NotNull</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">WebSocketSession</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u53EF\u4EE5\u901A\u8FC7 session.getHandshakeHeaders().getFirst(&quot;x-self-id&quot;) \u83B7\u53D6\u4E0A\u7EBF\u7684\u673A\u5668\u4EBA\u8D26\u53F7</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u4F8B\u5982\u5F53\u670D\u52A1\u7AEF\u4E3A\u5F00\u653E\u670D\u52A1\u65F6\uFF0C\u5E76\u4E14\u53EA\u6709\u767D\u540D\u5355\u5185\u7684\u8D26\u53F7\u624D\u5141\u8BB8\u8FDE\u63A5\uFF0C\u6B64\u65F6\u53EF\u4EE5\u68C0\u67E5\u8D26\u53F7\u662F\u5426\u5B58\u5728\u4E8E\u767D\u540D\u5185</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// \u4E0D\u5B58\u5728\u7684\u8BDD\u8FD4\u56DE false \u5373\u53EF\u7981\u6B62\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u81EA\u5B9A\u4E49\u8BF7\u6C42" tabindex="-1">\u81EA\u5B9A\u4E49\u8BF7\u6C42 <a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u8BF7\u6C42" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">\u63D0\u793A</p><p>\u5F53\u5BA2\u6237\u7AEF\u63D0\u4F9B\u4E86\u67D0\u4E9B <code>Action</code> \u8BF7\u6C42\uFF0C\u4F46\u662F <code>Shiro</code> \u5C1A\u672A\u652F\u6301\u65F6\uFF0C\u53EF\u4EE5\u53D1\u8D77\u81EA\u5B9A\u4E49\u8BF7\u6C42\uFF0C\u4EE5\u4E0B\u4EE3\u7801\u4E3A\u5BF9 <code>go-cqhttp</code> \u7684 <code>\u5220\u9664\u597D\u53CB</code> \u52A8\u4F5C\u7684\u793A\u8303</p></div><blockquote><p>\u81EA\u5B9A\u4E49\u4E00\u4E2A\u679A\u4E3E\u7C7B\u578B\u5E76\u5B9E\u73B0 <code>ActionPath</code></p></blockquote><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Getter</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">enum</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CustomActionPath</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ActionPath</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u5B9A\u4E49 Endpoint</span></span>
<span class="line"><span style="color:#A6ACCD;">    DELETE_FRIEND</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">delete_friend</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">CustomActionPath</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getPath</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u53D1\u8D77\u8BF7\u6C42</p></blockquote><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u5B9A\u4E49\u9700\u8981\u5220\u9664\u7684\u597D\u53CB\u8D26\u53F7</span></span>
<span class="line"><span style="color:#A6ACCD;">val friend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12345678L</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// \u83B7\u53D6 Endpoint</span></span>
<span class="line"><span style="color:#A6ACCD;">val action </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CustomActionPath</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DELETE_FRIEND</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// \u6784\u5EFA\u8BF7\u6C42\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">val params </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">JSONObject</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">put</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">friend_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> friend</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}};</span></span>
<span class="line"><span style="color:#676E95;">// \u53C2\u8003 Bot \u7C7B\u5BF9\u54CD\u5E94\u7ED3\u679C\u8FDB\u884C\u5904\u7406</span></span>
<span class="line"><span style="color:#A6ACCD;">val result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">customRequest</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6" tabindex="-1">\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#\u8FDB\u9636\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">\u63D0\u793A</p><p>\u4EE5\u4E0B\u914D\u7F6E\u6587\u4EF6\u4E3A\u8FDB\u9636\u914D\u7F6E\uFF0C\u5982\u6709\u9057\u6F0F\u6B22\u8FCE\u8865\u5145</p><p><code>ws-config</code> <code>task-pool</code> \u5927\u591A\u6570\u60C5\u51B5\u4E0B\u4FDD\u6301\u9ED8\u8BA4\u5373\u53EF</p></div><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">shiro</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># \u6CE8\u89E3\u65B9\u5F0F\u7F16\u5199\u7684\u63D2\u4EF6\u65E0\u9700\u5728\u63D2\u4EF6\u5217\u8868\uFF08plugin-list\uFF09\u5B9A\u4E49</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># \u63D2\u4EF6\u5217\u8868\u4E3A\u987A\u5E8F\u6267\u884C\uFF0C\u5982\u679C\u524D\u4E00\u4E2A\u63D2\u4EF6\u8FD4\u56DE\u4E86 MESSAGE_BLOCK \u5C06\u4E0D\u4F1A\u6267\u884C\u540E\u7EED\u63D2\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugin-list</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mikuac.example.plugins.PluginOne</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mikuac.example.plugins.PluginTwo</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># \u62E6\u622A\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">interceptor</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mikuac.example.interceptor.InterceptorExample</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># WebSocket \u914D\u7F6E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">ws-config</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u53CD\u5411 Websocket \u8FDE\u63A5\u5730\u5740\uFF0C\u65E0\u9700\u8BE5\u914D\u7F6E\u5B57\u6BB5\u53EF\u5220\u9664\uFF0C\u5C06\u4F7F\u7528\u9ED8\u8BA4\u503C &quot;/ws/shiro&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ws-url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/ws/shiro</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u8BBF\u95EE\u5BC6\u94A5\uFF0C\u5F3A\u70C8\u63A8\u8350\u5728\u516C\u7F51\u7684\u670D\u52A1\u5668\u8BBE\u7F6E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">access-token</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u8D85\u65F6\u56DE\u6536\uFF0C\u9ED8\u8BA410\u79D2</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">do-request-timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100000</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u4E8C\u8FDB\u5236\u6D88\u606F\u7684\u6700\u5927\u957F\u5EA6</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">max-binary-message-buffer-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">512000</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u6700\u5927\u7A7A\u95F2\u65F6\u95F4\uFF0C\u8D85\u8FC7\u8FD9\u4E2A\u65F6\u95F4\u5C06\u5173\u95ED\u4F1A\u8BDD</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">max-session-idle-timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">900000</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u6700\u5927\u6587\u672C\u6D88\u606F\u7F13\u51B2\u533A</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">max-text-message-buffer-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">512000</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># \u9650\u901F\u5668\uFF08\u4EE4\u724C\u6876\u7B97\u6CD5\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">limiter</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u662F\u5426\u542F\u7528\u9650\u901F\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">enable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u8865\u5145\u901F\u7387\uFF08\u6BCF\u79D2\u8865\u5145\u7684\u4EE4\u724C\u6570\u91CF\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u4EE4\u724C\u6876\u5BB9\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">capacity</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#676E95;"># \u5982\u679C\u8BE5\u503C\u4E3A false \u65F6\uFF0C\u5F53\u4EE4\u724C\u83B7\u53D6\u5931\u8D25\u5219\u4F1A\u76F4\u63A5\u4E22\u6B21\u672C\u6B21\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#676E95;"># \u5982\u679C\u8BE5\u503C\u4E3A true \u65F6\uFF0C\u5F53\u4EE4\u724C\u83B7\u53D6\u5931\u8D25\u5219\u4F1A\u963B\u585E\u5F53\u524D\u7EBF\u7A0B\uFF0C\u540E\u7EED\u4EFB\u52A1\u5C06\u88AB\u6DFB\u52A0\u5230\u7B49\u5F85\u961F\u5217</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">awaitTask</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u7B49\u5F85\u8D85\u65F6</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># \u7EBF\u7A0B\u6C60\u914D\u7F6E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">task-pool</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u6838\u5FC3\u7EBF\u7A0B\u6570\uFF08\u9ED8\u8BA4\u7EBF\u7A0B\u6570\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">core-pool-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u7F13\u51B2\u961F\u5217\u5927\u5C0F</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">queue-capacity</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u5141\u8BB8\u7EBF\u7A0B\u7A7A\u95F2\u65F6\u95F4\uFF08\u5355\u4F4D\uFF1A\u9ED8\u8BA4\u4E3A\u79D2\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">keep-alive-time</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u6700\u5927\u7EBF\u7A0B\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">max-pool-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># \u7EBF\u7A0B\u6C60\u540D\u524D\u7F00</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">thread-name-prefix</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ShiroTaskPool-</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div>`,39),e=[o];function c(t,r,D,y,F,A){return a(),n("div",null,e)}const d=s(p,[["render",c]]);export{i as __pageData,d as default};
